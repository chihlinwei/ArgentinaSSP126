geom_polygon(data=arg, aes(x=X, y=Y, group=PID), fill="bisque2", colour="transparent")+
geom_sf(data=as(eez, "sf"), fill="transparent", colour="red")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-200, linetype=2, colour="gray50")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-4000, linetype=1, colour="gray50")+
geom_point(data=hake, aes(x=decimalLongitude, y=decimalLatitude), size=0.2)+
facet_grid(Taxa~var, nrow=1)+
scale_fill_gradientn(colours=jet.colors(10))+
scale_x_continuous(expand = expansion(mult = 0))+
scale_y_continuous(expand = expansion(mult = 0))+
labs(x=NULL, y=NULL, fill="Habitat\nSuitability")+
theme_bw() %+replace% theme(legend.position = "right", legend.key.width =  unit(0.5, 'cm'))
ggplot(dat) +
geom_raster(aes(x=x, y=y, fill=value))+
geom_polygon(data=arg, aes(x=X, y=Y, group=PID), fill="bisque2", colour="transparent")+
geom_sf(data=as(eez, "sf"), fill="transparent", colour="red")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-200, linetype=2, colour="gray50")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-4000, linetype=1, colour="gray50")+
geom_point(data=hake, aes(x=decimalLongitude, y=decimalLatitude), size=0.2)+
facet_grid(Taxa~var)+
scale_fill_gradientn(colours=jet.colors(10))+
scale_x_continuous(expand = expansion(mult = 0))+
scale_y_continuous(expand = expansion(mult = 0))+
labs(x=NULL, y=NULL, fill="Habitat\nSuitability")+
theme_bw() %+replace% theme(legend.position = "right", legend.key.width =  unit(0.5, 'cm'))
dat <- rbind(
r1 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Argentine hake"),
r2 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Demosponge"),
r3 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Coldwater coral")
)
ggplot(dat) +
geom_raster(aes(x=x, y=y, fill=value))+
geom_polygon(data=arg, aes(x=X, y=Y, group=PID), fill="bisque2", colour="transparent")+
geom_sf(data=as(eez, "sf"), fill="transparent", colour="red")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-200, linetype=2, colour="gray50")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-4000, linetype=1, colour="gray50")+
geom_point(data=occ, aes(x=decimalLongitude, y=decimalLatitude), size=0.2)+
facet_grid(Taxa~var)+
scale_fill_gradientn(colours=jet.colors(10))+
scale_x_continuous(expand = expansion(mult = 0))+
scale_y_continuous(expand = expansion(mult = 0))+
labs(x=NULL, y=NULL, fill="Habitat\nSuitability")+
theme_bw() %+replace% theme(legend.position = "right", legend.key.width =  unit(0.5, 'cm'))
dat <- rbind(
r1 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Argentine hake"),
r2 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Demosponge"),
r3 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Coldwater coral")
)
ggplot(dat) +
geom_raster(aes(x=x, y=y, fill=value))+
geom_polygon(data=arg, aes(x=X, y=Y, group=PID), fill="bisque2", colour="transparent")+
geom_sf(data=as(eez, "sf"), fill="transparent", colour="red")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-200, linetype=2, colour="gray50")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-4000, linetype=1, colour="gray50")+
geom_point(data=occ, aes(x=decimalLongitude, y=decimalLatitude), size=0.2)+
facet_grid(Taxa~var)+
scale_fill_gradientn(colours=jet.colors(10))+
scale_x_continuous(expand = expansion(mult = 0))+
scale_y_continuous(expand = expansion(mult = 0))+
labs(x=NULL, y=NULL, fill="Habitat\nSuitability")+
theme_bw() %+replace% theme(legend.position = "right", legend.key.width =  unit(0.5, 'cm'))
dat <- rbind(
r1 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Argentine hake"),
r2 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Demosponge"),
r3 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Coldwater coral")
)
ggplot(dat) +
geom_raster(aes(x=x, y=y, fill=value))+
geom_polygon(data=arg, aes(x=X, y=Y, group=PID), fill="bisque2", colour="transparent")+
geom_sf(data=as(eez, "sf"), fill="transparent", colour="red")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-200, linetype=2, colour="gray50")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-4000, linetype=1, colour="gray50")+
geom_point(data=occ, aes(x=decimalLongitude, y=decimalLatitude), size=0.2)+
facet_grid(Taxa~var)+
scale_fill_gradientn(colours=jet.colors(10))+
scale_x_continuous(expand = expansion(mult = 0))+
scale_y_continuous(expand = expansion(mult = 0))+
labs(x=NULL, y=NULL, fill="Habitat\nSuitability")+
theme_bw() %+replace% theme(legend.position = "right", legend.key.width =  unit(0.5, 'cm'))
dat <- rbind(
r1 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Argentine hake"),
r2 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Demosponge"),
r3 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Coldwater coral")
)
ggplot(dat) +
geom_raster(aes(x=x, y=y, fill=value))+
geom_polygon(data=arg, aes(x=X, y=Y, group=PID), fill="bisque2", colour="transparent")+
geom_sf(data=as(eez, "sf"), fill="transparent", colour="red")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-200, linetype=2, colour="gray50")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-4000, linetype=1, colour="gray50")+
geom_point(data=occ, aes(x=decimalLongitude, y=decimalLatitude), size=0.2)+
facet_grid(Taxa~var)+
scale_fill_gradientn(colours=jet.colors(10))+
scale_x_continuous(expand = expansion(mult = 0))+
scale_y_continuous(expand = expansion(mult = 0))+
labs(x=NULL, y=NULL, fill="Habitat\nSuitability")+
theme_bw() %+replace% theme(legend.position = "right", legend.key.width =  unit(0.5, 'cm'))
dat <- rbind(
r1 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Argentine hake"),
r2 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Demosponge"),
r3 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Coldwater coral")
)
ggplot(dat) +
geom_raster(aes(x=x, y=y, fill=value))+
geom_polygon(data=arg, aes(x=X, y=Y, group=PID), fill="bisque2", colour="transparent")+
geom_sf(data=as(eez, "sf"), fill="transparent", colour="red")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-200, linetype=2, colour="gray50")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-4000, linetype=1, colour="gray50")+
geom_point(data=occ, aes(x=decimalLongitude, y=decimalLatitude), size=0.2)+
facet_grid(var~Taxa)+
scale_fill_gradientn(colours=jet.colors(10))+
scale_x_continuous(expand = expansion(mult = 0))+
scale_y_continuous(expand = expansion(mult = 0))+
labs(x=NULL, y=NULL, fill="Habitat\nSuitability")+
theme_bw() %+replace% theme(legend.position = "right", legend.key.width =  unit(0.5, 'cm'))
dat <- rbind(
r1 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Argentine hake"),
r2 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Demosponge"),
r3 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Coldwater coral")
)
ggplot(dat) +
geom_raster(aes(x=x, y=y, fill=value))+
geom_polygon(data=arg, aes(x=X, y=Y, group=PID), fill="bisque2", colour="transparent")+
geom_sf(data=as(eez, "sf"), fill="transparent", colour="red")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-200, linetype=2, colour="gray50")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-4000, linetype=1, colour="gray50")+
geom_point(data=occ, aes(x=decimalLongitude, y=decimalLatitude), size=0.2)+
facet_grid(var~Taxa)+
scale_fill_gradientn(colours=jet.colors(10))+
scale_x_continuous(expand = expansion(mult = 0))+
scale_y_continuous(expand = expansion(mult = 0))+
labs(x=NULL, y=NULL, fill="Habitat\nSuitability")+
theme_bw() %+replace% theme(legend.position = "right", legend.key.width =  unit(0.5, 'cm'))
dat <- rbind(
r1 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Argentine hake"),
r2 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Demosponge"),
r3 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Coldwater coral")
)
ggplot(dat) +
geom_raster(aes(x=x, y=y, fill=value))+
geom_polygon(data=arg, aes(x=X, y=Y, group=PID), fill="bisque2", colour="transparent")+
geom_sf(data=as(eez, "sf"), fill="transparent", colour="red")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-200, linetype=2, colour="gray50")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-4000, linetype=1, colour="gray50")+
geom_point(data=occ, aes(x=decimalLongitude, y=decimalLatitude), size=0.2, alpha=0.5)+
facet_grid(var~Taxa)+
scale_fill_gradientn(colours=jet.colors(10))+
scale_x_continuous(expand = expansion(mult = 0))+
scale_y_continuous(expand = expansion(mult = 0))+
labs(x=NULL, y=NULL, fill="Habitat\nSuitability")+
theme_bw() %+replace% theme(legend.position = "right", legend.key.width =  unit(0.5, 'cm'))
dat <- rbind(
r1 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Argentine hake"),
r2 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Demosponge"),
r3 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Coldwater coral")
)
ggplot(dat) +
geom_raster(aes(x=x, y=y, fill=value))+
geom_polygon(data=arg, aes(x=X, y=Y, group=PID), fill="bisque2", colour="transparent")+
geom_sf(data=as(eez, "sf"), fill="transparent", colour="red")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-200, linetype=2, colour="gray50")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-4000, linetype=1, colour="gray50")+
geom_point(data=occ, aes(x=decimalLongitude, y=decimalLatitude), size=0.2, alpha=0.2)+
facet_grid(var~Taxa)+
scale_fill_gradientn(colours=jet.colors(10))+
scale_x_continuous(expand = expansion(mult = 0))+
scale_y_continuous(expand = expansion(mult = 0))+
labs(x=NULL, y=NULL, fill="Habitat\nSuitability")+
theme_bw() %+replace% theme(legend.position = "right", legend.key.width =  unit(0.5, 'cm'))
dat <- rbind(
r1 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Argentine hake"),
r2 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Demosponge"),
r3 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Coldwater coral")
)
ggplot(dat) +
geom_raster(aes(x=x, y=y, fill=value))+
geom_polygon(data=arg, aes(x=X, y=Y, group=PID), fill="bisque2", colour="transparent")+
geom_sf(data=as(eez, "sf"), fill="transparent", colour="red")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-200, linetype=2, colour="gray50")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-4000, linetype=1, colour="gray50")+
geom_point(data=occ, aes(x=decimalLongitude, y=decimalLatitude), size=0.2)+
facet_grid(var~Taxa)+
scale_fill_gradientn(colours=jet.colors(10))+
scale_x_continuous(expand = expansion(mult = 0))+
scale_y_continuous(expand = expansion(mult = 0))+
labs(x=NULL, y=NULL, fill="Habitat\nSuitability")+
theme_bw() %+replace% theme(legend.position = "right", legend.key.width =  unit(0.5, 'cm'))
dat <- rbind(
r1 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Argentine hake"),
r2 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Demosponge"),
r3 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Coldwater coral")
)
ggplot(dat) +
geom_raster(aes(x=x, y=y, fill=value))+
geom_polygon(data=arg, aes(x=X, y=Y, group=PID), fill="bisque2", colour="transparent")+
geom_sf(data=as(eez, "sf"), fill="transparent", colour="red")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-200, linetype=2, colour="gray50")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-4000, linetype=1, colour="gray50")+
geom_point(data=occ, aes(x=decimalLongitude, y=decimalLatitude), size=0.2)+
facet_grid(var~Taxa)+
scale_fill_gradientn(colours=jet.colors(10))+
scale_x_continuous(expand = expansion(mult = 0))+
scale_y_continuous(expand = expansion(mult = 0))+
labs(x=NULL, y=NULL, fill="Habitat\nSuitability")+
theme_bw() %+replace% theme(legend.position = "right", legend.key.width =  unit(0.5, 'cm'))
knitr::opts_chunk$set(
collapse = TRUE,
message=FALSE,
warning=FALSE,
comment = "#>"
)
library(ArgentinaSSP126)
library(ggplot2)
library(dplyr)
library(tidyr)
library(sf)
library(robis)
sponge <- occurrence(scientificname = "Demospongiae", areaid = 7)
hake <- occurrence(scientificname = "Merluccius hubbsi", areaid = 7)
cwc <- as.data.frame(coral)[,c("y", "x", "SPECIES")]
names(cwc) <- c("decimalLatitude", "decimalLongitude", "scientificName")
occ <- rbind(hake[, c(6:7, 21)] %>% cbind(Taxa="Argentine hake"),
sponge[, c(2:3, 6)] %>% cbind(Taxa="Demosponge"),
cwc %>% cbind(Taxa="Coldwater coral")
)
library(knitr)
head(hake[, c(6:7, 21)], 10) %>% kable
bathy <- etopo2022 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit
ggplot(bathy) +
geom_raster(aes(x=x, y=y, fill=-layer))+
geom_polygon(data=arg, aes(x=X, y=Y, group=PID), fill="bisque2", colour="transparent")+
geom_sf(data=as(eez, "sf"), fill="transparent", colour="red")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-200, linetype=2, colour="gray50")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-4000, linetype=1, colour="gray50")+
geom_point(data=occ, aes(x=decimalLongitude, y=decimalLatitude), size=0.8)+
facet_wrap(~Taxa)+
scale_fill_gradientn(colours=terrain.colors(7))+
scale_x_continuous(expand = expansion(mult = 0))+
scale_y_continuous(expand = expansion(mult = 0))+
labs(x=NULL, y=NULL, fill="Depth\n(m)")+
theme_bw() %+replace% theme(legend.position = "right", legend.key.width =  unit(0.5, 'cm'))
hist <- addLayer(etopo2022, cmip6_1950_2000_av) #%>% mask(eez)
names(hist)[-1] <- gsub("_av_1950_to_2000", "", names(cmip6_1950_2000_av))
proj1 <- addLayer(etopo2022, cmip6_2041_2060_av) #%>% mask(eez)
names(proj1)[-1] <- gsub("_av_2041_2060", "", names(cmip6_2041_2060_av))
proj2 <- addLayer(etopo2022, cmip6_2081_2100_av) #%>% mask(eez)
names(proj2)[-1] <- gsub("_av_2081_2100", "", names(cmip6_2081_2100_av))
library(dismo)
coordinates(occ) <- c("decimalLongitude", "decimalLatitude")
# Maxnet modeling for Argentine hake
me1 <- maxent(hist, subset(occ, Taxa=="Argentine hake"))
r1 <- addLayer(predict(me1, hist), predict(me1, proj1), predict(me1, proj2))
names(r1) <- c("Year_1950_to_2000", "Year_2041_to_2060", "Year_2081_to_2100")
# Maxnet modeling for Demosponge
me2 <- maxent(hist, subset(occ, Taxa=="Demosponge"))
r2 <- addLayer(predict(me2, hist), predict(me2, proj1), predict(me2, proj2))
names(r2) <- c("Year_1950_to_2000", "Year_2041_to_2060", "Year_2081_to_2100")
# Maxnet modeling for coldwater coral
me3 <- maxent(hist, subset(occ, Taxa=="Coldwater coral"))
r3 <- addLayer(predict(me3, hist), predict(me3, proj1), predict(me3, proj2))
names(r3) <- c("Year_1950_to_2000", "Year_2041_to_2060", "Year_2081_to_2100")
raster::extract(hist, subset(occ, Taxa=="Argentine hake")) %>% head(10) %>% kable(digits=3)
dat <- rbind(
r1 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Argentine hake"),
r2 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Demosponge"),
r3 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Coldwater coral")
)
ggplot(dat) +
geom_raster(aes(x=x, y=y, fill=value))+
geom_polygon(data=arg, aes(x=X, y=Y, group=PID), fill="bisque2", colour="transparent")+
geom_sf(data=as(eez, "sf"), fill="transparent", colour="red")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-200, linetype=2, colour="gray50")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-4000, linetype=1, colour="gray50")+
geom_point(data=occ, aes(x=decimalLongitude, y=decimalLatitude), size=0.2)+
facet_grid(var~Taxa)+
scale_fill_gradientn(colours=jet.colors(10))+
scale_x_continuous(expand = expansion(mult = 0))+
scale_y_continuous(expand = expansion(mult = 0))+
labs(x=NULL, y=NULL, fill="Habitat\nSuitability")+
theme_bw() %+replace% theme(legend.position = "right", legend.key.width =  unit(0.5, 'cm'))
dat
ggplot(dat) +
geom_raster(aes(x=x, y=y, fill=value))+
geom_polygon(data=arg, aes(x=X, y=Y, group=PID), fill="bisque2", colour="transparent")+
geom_sf(data=as(eez, "sf"), fill="transparent", colour="red")
ggplot(dat) +
geom_raster(aes(x=x, y=y, fill=value))+
geom_polygon(data=arg, aes(x=X, y=Y, group=PID), fill="bisque2", colour="transparent")+
geom_sf(data=as(eez, "sf"), fill="transparent", colour="red")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-200, linetype=2, colour="gray50")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-4000, linetype=1, colour="gray50")+
geom_point(data=occ, aes(x=decimalLongitude, y=decimalLatitude), size=0.2)
occ
occ %>% as.data.frame
dat <- rbind(
r1 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Argentine hake"),
r2 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Demosponge"),
r3 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Coldwater coral")
)
ggplot(dat) +
geom_raster(aes(x=x, y=y, fill=value))+
geom_polygon(data=arg, aes(x=X, y=Y, group=PID), fill="bisque2", colour="transparent")+
geom_sf(data=as(eez, "sf"), fill="transparent", colour="red")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-200, linetype=2, colour="gray50")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-4000, linetype=1, colour="gray50")+
geom_point(data=occ %>% as.data.frame, aes(x=decimalLongitude, y=decimalLatitude), size=0.2)+
facet_grid(var~Taxa)+
scale_fill_gradientn(colours=jet.colors(10))+
scale_x_continuous(expand = expansion(mult = 0))+
scale_y_continuous(expand = expansion(mult = 0))+
labs(x=NULL, y=NULL, fill="Habitat\nSuitability")+
theme_bw() %+replace% theme(legend.position = "right", legend.key.width =  unit(0.5, 'cm'))
dat <- rbind(
r1 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Argentine hake"),
r2 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Demosponge"),
r3 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Coldwater coral")
)
ggplot(dat) +
geom_raster(aes(x=x, y=y, fill=value))+
geom_polygon(data=arg, aes(x=X, y=Y, group=PID), fill="bisque2", colour="transparent")+
geom_sf(data=as(eez, "sf"), fill="transparent", colour="red")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-200, linetype=2, colour="gray50")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-4000, linetype=1, colour="gray50")+
#geom_point(data=occ %>% as.data.frame, aes(x=decimalLongitude, y=decimalLatitude), size=0.2)+
facet_grid(var~Taxa)+
scale_fill_gradientn(colours=jet.colors(10))+
scale_x_continuous(expand = expansion(mult = 0))+
scale_y_continuous(expand = expansion(mult = 0))+
labs(x=NULL, y=NULL, fill="Habitat\nSuitability")+
theme_bw() %+replace% theme(legend.position = "right", legend.key.width =  unit(0.5, 'cm'))
dat <- rbind(
r1 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Argentine hake"),
r2 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Demosponge"),
r3 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Coldwater coral")
)
ggplot(dat) +
geom_raster(aes(x=x, y=y, fill=value))+
geom_polygon(data=arg, aes(x=X, y=Y, group=PID), fill="bisque2", colour="transparent")+
geom_sf(data=as(eez, "sf"), fill="transparent", colour="red")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-200, linetype=2, colour="gray50")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-4000, linetype=1, colour="gray50")+
#geom_point(data=occ %>% as.data.frame, aes(x=decimalLongitude, y=decimalLatitude), size=0.2)+
facet_grid(var~Taxa)+
scale_fill_gradientn(colours=jet.colors(10))+
scale_x_continuous(expand = expansion(mult = 0))+
scale_y_continuous(expand = expansion(mult = 0))+
labs(x=NULL, y=NULL, fill="Habitat\nSuitability")+
theme_bw() %+replace% theme(legend.position = "right", legend.key.width =  unit(0.5, 'cm'))
dat <- rbind(
r1 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Argentine hake"),
r2 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Demosponge"),
r3 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Coldwater coral")
)
ggplot(dat) +
geom_raster(aes(x=x, y=y, fill=value))+
geom_polygon(data=arg, aes(x=X, y=Y, group=PID), fill="bisque2", colour="transparent")+
geom_sf(data=as(eez, "sf"), fill="transparent", colour="red")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-200, linetype=2, colour="gray50")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-4000, linetype=1, colour="gray50")+
#geom_point(data=occ %>% as.data.frame, aes(x=decimalLongitude, y=decimalLatitude), size=0.2)+
facet_grid(var~Taxa)+
scale_fill_gradientn(colours=jet.colors(10))+
scale_x_continuous(expand = expansion(mult = 0))+
scale_y_continuous(expand = expansion(mult = 0))+
labs(x=NULL, y=NULL, fill="Habitat\nSuitability")+
theme_bw() %+replace% theme(legend.position = "right", legend.key.width =  unit(0.5, 'cm'))
sponge <- occurrence(scientificname = "Demospongiae", areaid = 7)
hake <- occurrence(scientificname = "Merluccius hubbsi", areaid = 7)
shrimp <- occurrence(scientificname = "Pleoticus muelleri", areaid = 7)
crab <- occurrence(scientificname = "Pleoticus muelleri", areaid = 7)
cwc <- as.data.frame(coral)[,c("y", "x", "SPECIES")]
names(cwc) <- c("decimalLatitude", "decimalLongitude", "scientificName")
head(shrimp)
shrimp[, c(6:7, 21)] %>% cbind(Taxa="Argentina red shrimp")
occ <- rbind(hake[, c(6:7, 21)] %>% cbind(Taxa="Argentine hake"),
shrimp[, c(6:7, 21)] %>% cbind(Taxa="Argentina red shrimp"),
crab[, c(6:7, 21)] %>% cbind(Taxa="Chilean king crab"),
sponge[, c(2:3, 6)] %>% cbind(Taxa="Demosponge"),
cwc %>% cbind(Taxa="Coldwater coral")
)
library(knitr)
head(hake[, c(6:7, 21)], 10) %>% kable
bathy <- etopo2022 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit
ggplot(bathy) +
geom_raster(aes(x=x, y=y, fill=-layer))+
geom_polygon(data=arg, aes(x=X, y=Y, group=PID), fill="bisque2", colour="transparent")+
geom_sf(data=as(eez, "sf"), fill="transparent", colour="red")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-200, linetype=2, colour="gray50")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-4000, linetype=1, colour="gray50")+
geom_point(data=occ, aes(x=decimalLongitude, y=decimalLatitude), size=0.8)+
facet_wrap(~Taxa)+
scale_fill_gradientn(colours=terrain.colors(7))+
scale_x_continuous(expand = expansion(mult = 0))+
scale_y_continuous(expand = expansion(mult = 0))+
labs(x=NULL, y=NULL, fill="Depth\n(m)")+
theme_bw() %+replace% theme(legend.position = "right", legend.key.width =  unit(0.5, 'cm'))
bathy <- etopo2022 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit
ggplot(bathy) +
geom_raster(aes(x=x, y=y, fill=-layer))+
geom_polygon(data=arg, aes(x=X, y=Y, group=PID), fill="bisque2", colour="transparent")+
geom_sf(data=as(eez, "sf"), fill="transparent", colour="red")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-200, linetype=2, colour="gray50")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-4000, linetype=1, colour="gray50")+
geom_point(data=occ, aes(x=decimalLongitude, y=decimalLatitude), size=0.8)+
facet_wrap(~Taxa)+
scale_fill_gradientn(colours=terrain.colors(7))+
scale_x_continuous(expand = expansion(mult = 0))+
scale_y_continuous(expand = expansion(mult = 0))+
labs(x=NULL, y=NULL, fill="Depth\n(m)")+
theme_bw() %+replace% theme(legend.position = "right", legend.key.width =  unit(0.5, 'cm'))
bathy <- etopo2022 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit
ggplot(bathy) +
geom_raster(aes(x=x, y=y, fill=-layer))+
geom_polygon(data=arg, aes(x=X, y=Y, group=PID), fill="bisque2", colour="transparent")+
geom_sf(data=as(eez, "sf"), fill="transparent", colour="red")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-200, linetype=2, colour="gray50")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-4000, linetype=1, colour="gray50")+
geom_point(data=occ, aes(x=decimalLongitude, y=decimalLatitude), size=0.8)+
facet_wrap(~Taxa, nrow=1)+
scale_fill_gradientn(colours=terrain.colors(7))+
scale_x_continuous(expand = expansion(mult = 0))+
scale_y_continuous(expand = expansion(mult = 0))+
labs(x=NULL, y=NULL, fill="Depth\n(m)")+
theme_bw() %+replace% theme(legend.position = "right", legend.key.width =  unit(0.5, 'cm'))
crab <- occurrence(scientificname = "Lithodes santolla", areaid = 7)
occ <- rbind(hake[, c(6:7, 21)] %>% cbind(Taxa="Argentine hake"),
shrimp[, c(6:7, 21)] %>% cbind(Taxa="Argentina red shrimp"),
crab[, c(6:7, 21)] %>% cbind(Taxa="Chilean king crab"),
sponge[, c(2:3, 6)] %>% cbind(Taxa="Demosponge"),
cwc %>% cbind(Taxa="Coldwater coral")
)
bathy <- etopo2022 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit
ggplot(bathy) +
geom_raster(aes(x=x, y=y, fill=-layer))+
geom_polygon(data=arg, aes(x=X, y=Y, group=PID), fill="bisque2", colour="transparent")+
geom_sf(data=as(eez, "sf"), fill="transparent", colour="red")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-200, linetype=2, colour="gray50")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-4000, linetype=1, colour="gray50")+
geom_point(data=occ, aes(x=decimalLongitude, y=decimalLatitude), size=0.8)+
facet_wrap(~Taxa, nrow=1)+
scale_fill_gradientn(colours=terrain.colors(7))+
scale_x_continuous(expand = expansion(mult = 0))+
scale_y_continuous(expand = expansion(mult = 0))+
labs(x=NULL, y=NULL, fill="Depth\n(m)")+
theme_bw() %+replace% theme(legend.position = "right", legend.key.width =  unit(0.5, 'cm'))
hist <- addLayer(etopo2022, cmip6_1950_2000_av) #%>% mask(eez)
names(hist)[-1] <- gsub("_av_1950_to_2000", "", names(cmip6_1950_2000_av))
proj1 <- addLayer(etopo2022, cmip6_2041_2060_av) #%>% mask(eez)
names(proj1)[-1] <- gsub("_av_2041_2060", "", names(cmip6_2041_2060_av))
proj2 <- addLayer(etopo2022, cmip6_2081_2100_av) #%>% mask(eez)
names(proj2)[-1] <- gsub("_av_2081_2100", "", names(cmip6_2081_2100_av))
library(dismo)
coordinates(occ) <- c("decimalLongitude", "decimalLatitude")
# Maxnet modeling for Argentine hake
me1 <- maxent(hist, subset(occ, Taxa=="Argentine hake"))
r1 <- addLayer(predict(me1, hist), predict(me1, proj1), predict(me1, proj2))
names(r1) <- c("Year_1950_to_2000", "Year_2041_to_2060", "Year_2081_to_2100")
# Maxnet modeling for Argentina red shrimp
me2 <- maxent(hist, subset(occ, Taxa=="Argentina red shrimp"))
r2 <- addLayer(predict(me2, hist), predict(me2, proj1), predict(me2, proj2))
names(r2) <- c("Year_1950_to_2000", "Year_2041_to_2060", "Year_2081_to_2100")
# Maxnet modeling for coldwater coral
me3 <- maxent(hist, subset(occ, Taxa=="Chilean king crab"))
r3 <- addLayer(predict(me3, hist), predict(me3, proj1), predict(me3, proj2))
names(r3) <- c("Year_1950_to_2000", "Year_2041_to_2060", "Year_2081_to_2100")
# Maxnet modeling for Demosponge
me4 <- maxent(hist, subset(occ, Taxa=="Demosponge"))
r4 <- addLayer(predict(me4, hist), predict(me4, proj1), predict(me4, proj2))
names(r4) <- c("Year_1950_to_2000", "Year_2041_to_2060", "Year_2081_to_2100")
# Maxnet modeling for coldwater coral
me5 <- maxent(hist, subset(occ, Taxa=="Coldwater coral"))
r5 <- addLayer(predict(me5, hist), predict(me5, proj1), predict(me5, proj2))
names(r5) <- c("Year_1950_to_2000", "Year_2041_to_2060", "Year_2081_to_2100")
dat <- rbind(
r1 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Argentine hake"),
r2 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Argentina red shrimp"),
r3 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Chilean king crab"),
r2 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Demosponge"),
r3 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Coldwater coral")
)
ggplot(dat) +
geom_raster(aes(x=x, y=y, fill=value))+
geom_polygon(data=arg, aes(x=X, y=Y, group=PID), fill="bisque2", colour="transparent")+
geom_sf(data=as(eez, "sf"), fill="transparent", colour="red")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-200, linetype=2, colour="gray50")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-4000, linetype=1, colour="gray50")+
#geom_point(data=occ %>% as.data.frame, aes(x=decimalLongitude, y=decimalLatitude), size=0.2)+
facet_grid(var~Taxa)+
scale_fill_gradientn(colours=jet.colors(10))+
scale_x_continuous(expand = expansion(mult = 0))+
scale_y_continuous(expand = expansion(mult = 0))+
labs(x=NULL, y=NULL, fill="Habitat\nSuitability")+
theme_bw() %+replace% theme(legend.position = "right", legend.key.width =  unit(0.5, 'cm'))
dat <- rbind(
r1 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Argentine hake"),
r2 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Argentina red shrimp"),
r3 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Chilean king crab"),
r4 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Demosponge"),
r5 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit %>% gather(-x, -y, key = "var", value = "value") %>% cbind(Taxa="Coldwater coral")
)
ggplot(dat) +
geom_raster(aes(x=x, y=y, fill=value))+
geom_polygon(data=arg, aes(x=X, y=Y, group=PID), fill="bisque2", colour="transparent")+
geom_sf(data=as(eez, "sf"), fill="transparent", colour="red")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-200, linetype=2, colour="gray50")+
geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-4000, linetype=1, colour="gray50")+
#geom_point(data=occ %>% as.data.frame, aes(x=decimalLongitude, y=decimalLatitude), size=0.2)+
facet_grid(var~Taxa)+
scale_fill_gradientn(colours=jet.colors(10))+
scale_x_continuous(expand = expansion(mult = 0))+
scale_y_continuous(expand = expansion(mult = 0))+
labs(x=NULL, y=NULL, fill="Habitat\nSuitability")+
theme_bw() %+replace% theme(legend.position = "right", legend.key.width =  unit(0.5, 'cm'))
