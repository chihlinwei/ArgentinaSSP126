"0","all <- overlay(subset(cmip6_extoe_early, 1:4), fun=max) %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit"
"0","bathy <- etopo2022 %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit"
"0","p1 <- ggplot(all) +"
"0","      geom_raster(aes(x=x, y=y, fill=layer))+"
"0","      geom_polygon(data=arg, aes(x=X, y=Y, group=PID), fill=""bisque2"", colour=""transparent"")+"
"0","      geom_polygon(data=fortify(eez), aes(x=long, y=lat, group=id), fill=""transparent"", colour=""red"")+"
"0","      geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-200, linetype=2, colour=""gray50"")+"
"0","      geom_contour(data=bathy, aes(x=x, y=y, z=layer), breaks=-4000, linetype=1, colour=""gray50"")+"
"0","      scale_fill_gradientn(colours=brewer.pal(10, 'RdYlBu'))+"
"0","      scale_x_continuous(expand = expansion(mult = 0))+"
"0","      scale_y_continuous(expand = expansion(mult = 0))+"
"0","      labs(x=NULL, y=NULL, fill=NULL)+"
"0","      coord_fixed(1.52)+"
"0","      theme_bw() %+replace% theme(legend.position = ""right"", legend.key.height =  unit(1.8, 'cm'))"
"0",""
"0","# Violin plots"
"0","out <- addLayer(etopo2022, overlay(subset(cmip6_extoe_early, 1:4), fun=max)) %>% mask(eez) %>% as.data.frame(xy = TRUE) %>% na.omit"
"0","out$Region <- cut(-out$layer.1, c(0, 200, 5000), labels=c(""Shelf"", ""Slope""))"
"0",""
"0","p2 <- ggplot(data=out)+"
"0","  geom_violin(aes(x=Region, y=layer.2))+"
"0","  labs(y=""Time of Emergence of Climate Change"")"
